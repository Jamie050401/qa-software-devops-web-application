name: main

on:
  workflow_dispatch:
  push:
    branches: [ "main" ]

jobs:
  Build-Test:
    uses: ./.github/workflows/reusable-build-test.yml
    secrets: inherit

  Static-Analysis:
    uses: ./.github/workflows/reusable-static-analysis.yml
    secrets: inherit

  Publish:
    needs: Build-Test
    uses: ./.github/workflows/reusable-publish.yml
    secrets: inherit

  Deploy:
    needs: Publish
    uses: ./.github/workflows/reusable-deploy.yml
    with:
      git-branch: "main"
    secrets: inherit
